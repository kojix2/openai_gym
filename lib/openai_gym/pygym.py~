import gym
import sys
import numpy as np

env_name =  sys.stdin.readline().strip()
env = gym.make(env_name)

lines = int(sys.stdin.readline().strip())

prepro_text = ""
for i in range(lines):
  prepro_text += sys.stdin.readline()


exec(prepro_text)

while True:
    command = sys.stdin.readline().strip()

    if command == "reset":
        observation = env.reset()
        print(prepro(observation).tobytes())
    elif command == "render":
        env.render()
    elif command == "step":
        action = sys.stdin.readline().strip()
        action = int(action)
        observation, reward, done, info = env.step(action)
        print(prepro(observation).tobytes())
        print(reward)
        print(done)
        print(info)
    else:
        sys.stderr.write(command + " not known\n")
